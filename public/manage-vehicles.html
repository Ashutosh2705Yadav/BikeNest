<!doctype html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8">
  <title>Manage Vehicles - BikeNest</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="p-4">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Manage Vehicles</h2>
    <a href="/admin-dashboard.html" class="btn btn-outline-info">⬅ Back to Dashboard</a>
  </div>

  <table class="table table-dark table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>Image</th>
        <th>Name</th>
        <th>Rate/hr</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="vehiclesTable"></tbody>
  </table>

<script>
async function loadVehicles() {
  const res = await fetch('/api/vehicles');
  const vehicles = await res.json();

  let rows = "";
  vehicles.forEach(v => {
    rows += `
      <tr>
        <td>${v.id}</td>
        <td><img src="${v.image}" width="60"></td>
        <td>${v.name}</td>
        <td>₹${v.rate_per_hour}</td>
        <td class="${v.available ? 'text-success' : 'text-danger'}">
          ${v.available ? 'Available' : 'Unavailable'}
        </td>
        <td>
          <button class="btn btn-warning btn-sm" onclick="toggleAvailability('${v.id}')">
            Toggle
          </button>
          <button class="btn btn-danger btn-sm" onclick="deleteVehicle('${v.id}')">
            Delete
          </button>
        </td>
      </tr>
    `;
  });

  document.getElementById("vehiclesTable").innerHTML = rows;
}

async function deleteVehicle(id) {
  if (!confirm("Delete this vehicle?")) return;
  await fetch(`/api/vehicles/${id}`, { method: "DELETE" });
  loadVehicles();
}

async function toggleAvailability(id) {
  await fetch(`/api/vehicles/${id}`, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({})
  });
  loadVehicles();
}

loadVehicles();
</script>

</body>
</html>